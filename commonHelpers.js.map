{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// axios\nimport axios from 'axios';\n\nexport default  async function fetchPictures (URL,params) {\n\n  return  await axios.get(URL,params)\n  .then((response) => {\n    // console.log(response.data);\n    return response.data;\n  })\n  .catch(error => {\n    console.log(error);\n})\n\n}\n\n\n\n// export default  function fetchPictures (URL) {\n//   return fetch(URL)\n//   .then((response) => {\n//     if (!response.ok) {\n//       throw new Error(response.status);\n//     }\n//     return response.json();\n//   })\n// }\n\n","export default function setGallery(data, selector) {\n  const gallery = data.reduce((acc, item) => {\n    const {\n      likes,\n      views,\n      comments,\n      downloads,\n      tags,\n      previewURL,\n      largeImageURL,\n      webformatURL,\n    } = item;\n    acc += `<li class='gallery-item'>\n                  <a class='gallery-link' href= ${largeImageURL}>\n                    <img class=\"gallery-image\" src=${webformatURL} alt =\"${tags}\" width =\"360\" height =\"152\">\n                    </a>\n                      <div class =\"conteiner-comments\">\n                        <div class= \"container-comment\">\n                          <span class=\"comments-name\">Likes</span>\n                          <span class =\"comments-value\"> ${likes}</span>\n                        </div>\n                        <div class= \"container-comment\">\n                          <span class=\"comments-name\">Views</span>\n                          <span class =\"comments-value\"> ${views}</span>\n                        </div>\n                        <div class= \"container-comment\">\n                          <span class=\"comments-name\">Comments</span>\n                          <span class =\"comments-value\"> ${comments}</span>\n                         </div>\n                        <div class= \"container-comment\">\n                          <span class=\"comments-name\">Downloads</span>\n                          <span class =\"comments-value\"> ${downloads}</span>\n                        </div> \n                      </div>\n                      </li>`;\n    return acc;\n  }, '');\n\n  document.querySelector(selector).innerHTML += gallery;\n  \n return  document.querySelector(\"img\").getBoundingClientRect().height;\n \n\n}\n","// IMPORT\nimport fetchPictures from './js/pixabay-api.js';\nimport setGallery from './js/render-functions.js';\n// iziToast\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n// SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n// axios\nimport axios from 'axios';\n\n// VARIABLE\n// VARIABLE DOM\nconst formSearch = document.querySelector(\".form-search\");\nconst inputSearch = document.querySelector('.input-search');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnContinue = document.querySelector(\".btn-continue\");\nconst galleryImg = document.querySelector(\"img\");\n\n\n\n;\n\nloader.style.display = 'none';\n\n// VARIABLE API\nconst API_KEY = '15611929-f0ad527e9fe4615e5eed3c151';\nconst urlApi = `https://pixabay.com/api/?`;\n// const searchParams = new URLSearchParams({\n//   key: API_KEY,\n//   q: inputSearch.value,\n//   image_type: 'photo',\n//   orientation: 'horizontal',\n//   safesearch: true,\n// });\n\nlet heightScroll;\nlet page = 1;\nlet totalHits;\nconst perPages = 15;\nlet totalPages;\n\nconst params = {\n  key: API_KEY,\n  q: inputSearch.value,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: perPages,\n  page: page,\n}\n\n// FUNCTION\nfunction errorMessage(data) {\n  iziToast.error({\n    // title: 'Error:',\n    message: data,\n    position: 'topRight',\n    messageColor: 'white',\n    backgroundColor: 'rgb(238, 4, 50)',\n    theme: 'dark',\n    color: 'red',\n    maxWidth: '432',\n    messageSize: '16',\n    titleSize: '16',\n    progressBar: false,\n  });\n}\n\n\nconst lightbox = new SimpleLightbox('.gallery .gallery-item a', {\n  captionSelector: 'img',\n  captions: true,\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  overlayOpacity: 1,\n  className: 'custom-lightbox',\n  docClose: true,\n  animationSpeed: 500,\n  fadeSpeed: 500,\n  rtl: true,\n});\n\n\n// CODE\nbtnContinue.style.display =\"none\";\n\n\nloader.style.display = 'none';\nformSearch.addEventListener('submit', event => {\n  event.preventDefault();\n  btnContinue.style.display =\"none\";\n  gallery.textContent = '';\n  // searchParams.set(\"q\",inputSearch.value);\n  params.q = inputSearch.value;\n\n  if (inputSearch.value.trim() === '' || inputSearch.value.trim() === ' ') {\n    const messsage = 'please, fill the search request';\n    errorMessage(messsage);\n    return;\n  } \n  else {\n    loader.style.display = 'block';\n    // const URL = `${urlApi}${searchParams}`;\n      fetchPictures(urlApi, {params}).then(users => {\n        if (users.hits.length === 0) {\n          loader.style.display = 'none';\n          const messsage = `Sorry, there are no images matching your search query.\n                 Please try again!`;\n          errorMessage(messsage);\n          inputSearch.value = '';\n        } \n        else {\n          totalHits = users.total;\n          totalPages = Math.ceil(totalHits/perPages);\n          console.log(totalPages );\n          // console.log(totalHits);\n          // console.log(totalPages);\n\n          loader.style.display = 'none';\n          heightScroll = setGallery(users.hits, '.gallery');\n          window.scrollBy(0, heightScroll )\n        \n\n          lightbox.refresh();\n          console.log(users.hits.length);\n\n          console.log(perPages);\n\n          // inputSearch.value = '';\n          if ( users.hits.length  >  perPages || page < totalPages ) {\n            console.log(users.hits.length);\n\n            console.log(perPages);\n            btnContinue.style.display =\"block\";\n\n            // const messsage = 'We\"re sorry, but you\"ve reached the end of search results.';\n            // errorMessage(messsage);\n          }\n        }\n      \n        page=1\n        console.log(page);\n\n        // console.log(img.getBoundingClientRect() );\n\n      });\n\n  }\n});\n\nbtnContinue.addEventListener(\"click\", event => {\n  console.log(page );\n  console.log(totalPages);\n\nif(page >= totalPages) {\n  const messsage = 'We\"re sorry, but you\"ve reached the end of search results.';\n    errorMessage(messsage);\n    btnContinue.style.display =\"none\";\n}\nelse {\n  \n  page+=1\n  params.page = page;\n  console.log(page);\n  loader.style.display = 'block';\n\n    // const messsage = 'We\"re sorry, but you\"ve reached the end of search results.';\n    // errorMessage(messsage);\n    // btnContinue.style.display =\"none\";\n\n    fetchPictures(urlApi, {params}).then(users => {\n   \n      // console.log(\".gallery-item a\");\n        setGallery(users.hits, '.gallery');\n        window.scrollBy(0, heightScroll)\n        console.log(galleryImg );\n       \n        lightbox.refresh();\n        loader.style.display = 'none';\n        \n    \n  })\n\n\n          }\n\n//   fetchPictures(urlApi, {params}).then(users => {\n   \n//     // console.log(\".gallery-item a\");\n//       setGallery(users.hits, '.gallery');\n//       window.scrollBy(0, heightScroll)\n//       console.log(galleryImg );\n     \n//       lightbox.refresh();\n//       loader.style.display = 'none';\n      \n  \n// })\n})\n\nbtnContinue.style.display =\"none\";\n\n"],"names":["fetchPictures","URL","params","axios","response","error","setGallery","data","selector","gallery","acc","item","likes","views","comments","downloads","tags","previewURL","largeImageURL","webformatURL","formSearch","inputSearch","loader","btnContinue","galleryImg","API_KEY","urlApi","heightScroll","page","totalHits","perPages","totalPages","errorMessage","iziToast","lightbox","SimpleLightbox","event","users"],"mappings":"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"}